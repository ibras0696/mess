{"openapi":"3.1.0","info":{"title":"web-messenger","version":"0.1.0"},"paths":{"/api/healthz":{"get":{"tags":["health"],"summary":"Service liveness probe","operationId":"healthcheck_api_healthz_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Healthcheck Api Healthz Get"}}}}}}},"/api/auth/register":{"post":{"tags":["auth"],"summary":"Register","operationId":"register_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenPair"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/login":{"post":{"tags":["auth"],"summary":"Login","operationId":"login_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenPair"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/refresh":{"post":{"tags":["auth"],"summary":"Refresh","operationId":"refresh_api_auth_refresh_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccessToken"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/me/token-test":{"get":{"tags":["auth"],"summary":"Token Test","description":"Debug-only endpoint to ensure auth dependency works.","operationId":"token_test_api_auth_me_token_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccessToken"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/users/me":{"get":{"tags":["users"],"summary":"Get Me","operationId":"get_me_api_users_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRead"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/users/{user_id}":{"get":{"tags":["users"],"summary":"Get User","operationId":"get_user_api_users__user_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chats":{"get":{"tags":["chats"],"summary":"List Chats","operationId":"list_chats_api_chats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/ChatRead"},"type":"array","title":"Response List Chats Api Chats Get"}}}}},"security":[{"HTTPBearer":[]}]},"post":{"tags":["chats"],"summary":"Create Chat","operationId":"create_chat_api_chats_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/chats/{chat_id}/messages":{"get":{"tags":["chats"],"summary":"List Messages","operationId":"list_messages_api_chats__chat_id__messages_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"chat_id","in":"path","required":true,"schema":{"type":"integer","title":"Chat Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":50,"title":"Limit"}},{"name":"before_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Before Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MessageRead"},"title":"Response List Messages Api Chats  Chat Id  Messages Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["chats"],"summary":"Send Message","operationId":"send_message_api_chats__chat_id__messages_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"chat_id","in":"path","required":true,"schema":{"type":"integer","title":"Chat Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SendMessageRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageRead"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/attachments/presign":{"post":{"tags":["attachments"],"summary":"Presign Upload","operationId":"presign_upload_api_attachments_presign_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PresignRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PresignResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/attachments/link":{"post":{"tags":["attachments"],"summary":"Link Attachment","operationId":"link_attachment_api_attachments_link_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AttachmentLinkRequest"}}},"required":true},"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/":{"get":{"tags":["meta"],"summary":"Root ping","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Root  Get"}}}}}}}},"components":{"schemas":{"AccessToken":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"}},"type":"object","required":["access_token"],"title":"AccessToken"},"AttachmentLinkRequest":{"properties":{"message_id":{"type":"integer","exclusiveMinimum":0.0,"title":"Message Id"},"object_key":{"type":"string","minLength":1,"title":"Object Key"},"file_name":{"type":"string","title":"File Name"},"content_type":{"type":"string","title":"Content Type"},"size_bytes":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Size Bytes"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url"}},"type":"object","required":["message_id","object_key","file_name","content_type"],"title":"AttachmentLinkRequest"},"AttachmentMeta":{"properties":{"object_key":{"type":"string","title":"Object Key"},"file_name":{"type":"string","title":"File Name"},"content_type":{"type":"string","title":"Content Type"},"size_bytes":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Size Bytes"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url"}},"type":"object","required":["object_key","file_name","content_type"],"title":"AttachmentMeta"},"AttachmentRead":{"properties":{"id":{"type":"integer","title":"Id"},"object_key":{"type":"string","title":"Object Key"},"file_name":{"type":"string","title":"File Name"},"content_type":{"type":"string","title":"Content Type"},"size_bytes":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Size Bytes"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","object_key","file_name","content_type","created_at"],"title":"AttachmentRead"},"ChatCreate":{"properties":{"type":{"type":"string","enum":["dialog","group"],"title":"Type"},"title":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Title"},"members":{"items":{"type":"integer"},"type":"array","minItems":1,"title":"Members"}},"type":"object","required":["type"],"title":"ChatCreate"},"ChatRead":{"properties":{"id":{"type":"integer","title":"Id"},"type":{"type":"string","enum":["dialog","group"],"title":"Type"},"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","type","title","created_at"],"title":"ChatRead"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","maxLength":255,"minLength":6,"title":"Password"}},"type":"object","required":["email","password"],"title":"LoginRequest"},"MessageRead":{"properties":{"id":{"type":"integer","title":"Id"},"chat_id":{"type":"integer","title":"Chat Id"},"sender_id":{"type":"integer","title":"Sender Id"},"text":{"type":"string","title":"Text"},"attachments":{"items":{"$ref":"#/components/schemas/AttachmentRead"},"type":"array","title":"Attachments"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","chat_id","sender_id","text","created_at"],"title":"MessageRead"},"PresignRequest":{"properties":{"filename":{"type":"string","maxLength":255,"minLength":1,"title":"Filename"},"content_type":{"type":"string","maxLength":255,"minLength":1,"title":"Content Type"},"size_bytes":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Size Bytes"}},"type":"object","required":["filename","content_type"],"title":"PresignRequest"},"PresignResponse":{"properties":{"url":{"type":"string","title":"Url"},"method":{"type":"string","title":"Method","default":"PUT"},"expires_in":{"type":"integer","title":"Expires In"},"object_key":{"type":"string","title":"Object Key"}},"type":"object","required":["url","expires_in","object_key"],"title":"PresignResponse"},"RefreshRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token"}},"type":"object","required":["refresh_token"],"title":"RefreshRequest"},"SendMessageRequest":{"properties":{"text":{"type":"string","minLength":1,"title":"Text"},"attachments":{"items":{"$ref":"#/components/schemas/AttachmentMeta"},"type":"array","title":"Attachments"}},"type":"object","required":["text"],"title":"SendMessageRequest"},"TokenPair":{"properties":{"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"type":"string","title":"Refresh Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"user":{"$ref":"#/components/schemas/UserRead"}},"type":"object","required":["access_token","refresh_token","user"],"title":"TokenPair"},"UserCreate":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"username":{"type":"string","maxLength":255,"minLength":1,"title":"Username"},"password":{"type":"string","maxLength":255,"minLength":6,"title":"Password"}},"type":"object","required":["email","username","password"],"title":"UserCreate"},"UserRead":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"username":{"type":"string","maxLength":255,"minLength":1,"title":"Username"},"id":{"type":"integer","title":"Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["email","username","id","created_at"],"title":"UserRead"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}